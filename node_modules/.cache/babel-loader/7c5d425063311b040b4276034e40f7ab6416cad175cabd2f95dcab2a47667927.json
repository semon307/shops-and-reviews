{"ast":null,"code":"import { createSlice } from '@reduxjs/toolkit';\nimport { shopsApi } from '../api/shops-api';\nconst initialState = {\n  shopsRequests: {},\n  isLoading: false,\n  error: null\n};\nconst slice = createSlice({\n  name: 'shopsReducer',\n  initialState: initialState,\n  reducers: {\n    setShopsAC(state, action) {\n      console.log('action.payload>>>', action.payload);\n      // const { shops, totalPageCount, searchQuery } = action.payload;\n      // state.shopsRequests[searchQuery].shops = shops;\n      // state.shopsRequests[searchQuery].totalPageCount = totalPageCount;\n    },\n\n    setLoadingAC(state, action) {\n      state.isLoading = action.payload;\n    },\n    setErrorAC(state, action) {\n      state.error = action.payload;\n    }\n  }\n});\nexport const shopsReducer = slice.reducer;\nexport const setShopsAC = slice.actions.setShopsAC;\nconst setLoadingAC = slice.actions.setLoadingAC;\nconst setErrorAC = slice.actions.setErrorAC;\nexport const setShopsTC = query => dispatch => {\n  dispatch(setErrorAC(null));\n  dispatch(setLoadingAC(true));\n  shopsApi.getShops(query).then(res => {\n    console.log('res.data', res === null || res === void 0 ? void 0 : res.data);\n    // dispatch(setShopsAC({\n    //   shops: res?.data?.shops,\n    //   searchQuery: query,\n    //   totalPageCount: res?.data?.metadata?.totalPageCount\n    // }));\n  }).catch(error => {\n    dispatch({\n      type: 'shops/error',\n      payload: error.message\n    });\n    dispatch(setErrorAC('Something went wrong:('));\n  }).finally(() => {\n    dispatch(setLoadingAC(false));\n  });\n};","map":{"version":3,"names":["createSlice","shopsApi","initialState","shopsRequests","isLoading","error","slice","name","reducers","setShopsAC","state","action","console","log","payload","setLoadingAC","setErrorAC","shopsReducer","reducer","actions","setShopsTC","query","dispatch","getShops","then","res","data","catch","type","message","finally"],"sources":["/Applications/work/test_tasks/coding-challenge-consumer-semen/src/redux/shops-reducer.ts"],"sourcesContent":["import { Dispatch } from 'redux';\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { Shop } from './types/shop/shop';\nimport { shopsApi } from '../api/shops-api';\n\nexport type ShopsState = {\n  // shops: Array<Shop>;\n  shopsRequests: {\n    [searchQuery: string]: {\n      shops: Array<Shop>;\n      totalPageCount: number;\n    };\n  };\n  isLoading: boolean;\n  error: string | null;\n};\n\nconst initialState: ShopsState = {\n  shopsRequests: {},\n  isLoading: false,\n  error: null,\n};\nconst slice = createSlice({\n  name: 'shopsReducer',\n  initialState: initialState,\n  reducers: {\n    setShopsAC(state, action: PayloadAction<{ shops: Array<Shop>; totalPageCount: number; searchQuery: string; }>) {\n      console.log('action.payload>>>', action.payload);\n      // const { shops, totalPageCount, searchQuery } = action.payload;\n      // state.shopsRequests[searchQuery].shops = shops;\n      // state.shopsRequests[searchQuery].totalPageCount = totalPageCount;\n    },\n    setLoadingAC(state, action: PayloadAction<boolean>) {\n      state.isLoading = action.payload;\n    },\n    setErrorAC(state, action: PayloadAction<string | null>) {\n      state.error = action.payload;\n    },\n  }\n});\n\nexport const shopsReducer = slice.reducer;\nexport const setShopsAC = slice.actions.setShopsAC;\nconst setLoadingAC = slice.actions.setLoadingAC;\nconst setErrorAC = slice.actions.setErrorAC;\n\n\nexport const setShopsTC = (query: string) => (dispatch: Dispatch) => {\n  dispatch(setErrorAC(null));\n  dispatch(setLoadingAC(true));\n  shopsApi.getShops(query)\n    .then((res) => {\n      console.log('res.data', res?.data);\n      // dispatch(setShopsAC({\n      //   shops: res?.data?.shops,\n      //   searchQuery: query,\n      //   totalPageCount: res?.data?.metadata?.totalPageCount\n      // }));\n    })\n    .catch((error) => {\n      dispatch({ type: 'shops/error', payload: error.message });\n      dispatch(setErrorAC('Something went wrong:('));\n    })\n    .finally(() => {\n      dispatch(setLoadingAC(false));\n    });\n};\n"],"mappings":"AACA,SAASA,WAAW,QAAuB,kBAAkB;AAE7D,SAASC,QAAQ,QAAQ,kBAAkB;AAc3C,MAAMC,YAAwB,GAAG;EAC/BC,aAAa,EAAE,CAAC,CAAC;EACjBC,SAAS,EAAE,KAAK;EAChBC,KAAK,EAAE;AACT,CAAC;AACD,MAAMC,KAAK,GAAGN,WAAW,CAAC;EACxBO,IAAI,EAAE,cAAc;EACpBL,YAAY,EAAEA,YAAY;EAC1BM,QAAQ,EAAE;IACRC,UAAUA,CAACC,KAAK,EAAEC,MAA2F,EAAE;MAC7GC,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAAEF,MAAM,CAACG,OAAO,CAAC;MAChD;MACA;MACA;IACF,CAAC;;IACDC,YAAYA,CAACL,KAAK,EAAEC,MAA8B,EAAE;MAClDD,KAAK,CAACN,SAAS,GAAGO,MAAM,CAACG,OAAO;IAClC,CAAC;IACDE,UAAUA,CAACN,KAAK,EAAEC,MAAoC,EAAE;MACtDD,KAAK,CAACL,KAAK,GAAGM,MAAM,CAACG,OAAO;IAC9B;EACF;AACF,CAAC,CAAC;AAEF,OAAO,MAAMG,YAAY,GAAGX,KAAK,CAACY,OAAO;AACzC,OAAO,MAAMT,UAAU,GAAGH,KAAK,CAACa,OAAO,CAACV,UAAU;AAClD,MAAMM,YAAY,GAAGT,KAAK,CAACa,OAAO,CAACJ,YAAY;AAC/C,MAAMC,UAAU,GAAGV,KAAK,CAACa,OAAO,CAACH,UAAU;AAG3C,OAAO,MAAMI,UAAU,GAAIC,KAAa,IAAMC,QAAkB,IAAK;EACnEA,QAAQ,CAACN,UAAU,CAAC,IAAI,CAAC,CAAC;EAC1BM,QAAQ,CAACP,YAAY,CAAC,IAAI,CAAC,CAAC;EAC5Bd,QAAQ,CAACsB,QAAQ,CAACF,KAAK,CAAC,CACrBG,IAAI,CAAEC,GAAG,IAAK;IACbb,OAAO,CAACC,GAAG,CAAC,UAAU,EAAEY,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEC,IAAI,CAAC;IAClC;IACA;IACA;IACA;IACA;EACF,CAAC,CAAC,CACDC,KAAK,CAAEtB,KAAK,IAAK;IAChBiB,QAAQ,CAAC;MAAEM,IAAI,EAAE,aAAa;MAAEd,OAAO,EAAET,KAAK,CAACwB;IAAQ,CAAC,CAAC;IACzDP,QAAQ,CAACN,UAAU,CAAC,wBAAwB,CAAC,CAAC;EAChD,CAAC,CAAC,CACDc,OAAO,CAAC,MAAM;IACbR,QAAQ,CAACP,YAAY,CAAC,KAAK,CAAC,CAAC;EAC/B,CAAC,CAAC;AACN,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}