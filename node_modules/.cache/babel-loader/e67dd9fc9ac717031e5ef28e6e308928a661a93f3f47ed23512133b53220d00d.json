{"ast":null,"code":"import { createSlice } from '@reduxjs/toolkit';\nimport { reviewsApi } from '../api/reviews-api';\nconst initialState = {};\nconst slice = createSlice({\n  name: 'ReviewsReducer',\n  initialState: initialState,\n  reducers: {\n    setReviewsAC(state, action) {\n      state[action.payload.tsId].reviews = action.payload.reviews;\n    },\n    setLoadingAC(state, action) {\n      state.loading = action.payload;\n    },\n    setErrorAC(state, action) {\n      state.error = action.payload;\n    }\n  }\n});\nexport const reviewsReducer = slice.reducer;\nexport const setReviewsAC = slice.actions.setReviewsAC;\nexport const setLoadingAC = slice.actions.setLoadingAC;\nexport const setErrorAC = slice.actions.setErrorAC;\nexport const reviewsTC = tsId => dispatch => {\n  dispatch(setLoadingAC(true));\n  dispatch(setErrorAC(null));\n  reviewsApi.getReviews(tsId).then(res => {\n    var _res$data$response$da, _res$data$response$da2;\n    console.log('REVIEWS>>>', res.data.response.data.shop.reviews);\n    dispatch(setReviewsAC({\n      reviews: (_res$data$response$da = res.data.response.data) === null || _res$data$response$da === void 0 ? void 0 : (_res$data$response$da2 = _res$data$response$da.shop) === null || _res$data$response$da2 === void 0 ? void 0 : _res$data$response$da2.reviews,\n      tsId\n    }));\n  }).catch(error => {\n    dispatch({\n      type: 'reviews/error',\n      payload: error.message\n    });\n    dispatch(setErrorAC('Something went wrong:('));\n  }).finally(() => {\n    dispatch(setLoadingAC(false));\n  });\n};","map":{"version":3,"names":["createSlice","reviewsApi","initialState","slice","name","reducers","setReviewsAC","state","action","payload","tsId","reviews","setLoadingAC","loading","setErrorAC","error","reviewsReducer","reducer","actions","reviewsTC","dispatch","getReviews","then","res","_res$data$response$da","_res$data$response$da2","console","log","data","response","shop","catch","type","message","finally"],"sources":["/Applications/work/test_tasks/coding-challenge-consumer-semen/src/redux/reviews-reducer.ts"],"sourcesContent":["import { Dispatch } from 'redux';\nimport { createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { Shop } from './types/Shop';\nimport { shopsApi } from '../api/shops-api';\nimport { Review } from './types/Review';\nimport { reviewsApi } from '../api/reviews-api';\n\nexport type ReviewsState = {\n  [tsId: string]: {\n    reviews: Array<Review>;\n    loading: boolean;\n    error: string | null;\n  };\n};\n\nconst initialState: ReviewsState = {};\nconst slice = createSlice({\n  name: 'ReviewsReducer',\n  initialState: initialState,\n  reducers: {\n    setReviewsAC(state, action: PayloadAction<{ tsId: string; reviews: Array<Review>; }>) {\n      state[action.payload.tsId].reviews = action.payload.reviews;\n    },\n    setLoadingAC(state, action: PayloadAction<{ tsId: string; isLoading: boolean; }>) {\n      state.loading = action.payload;\n    },\n    setErrorAC(state, action: PayloadAction<string | null>) {\n      state.error = action.payload;\n    },\n  }\n});\n\nexport const reviewsReducer = slice.reducer;\nexport const setReviewsAC = slice.actions.setReviewsAC;\nexport const setLoadingAC = slice.actions.setLoadingAC;\nexport const setErrorAC = slice.actions.setErrorAC;\n\n\nexport const reviewsTC = (tsId: string) => (dispatch: Dispatch) => {\n  dispatch(setLoadingAC(true));\n  dispatch(setErrorAC(null));\n  reviewsApi.getReviews(tsId)\n    .then((res) => {\n      console.log('REVIEWS>>>', res.data.response.data.shop.reviews);\n      dispatch(setReviewsAC({ reviews: res.data.response.data?.shop?.reviews, tsId }));\n    })\n    .catch((error) => {\n      dispatch({ type: 'reviews/error', payload: error.message });\n      dispatch(setErrorAC('Something went wrong:('));\n    })\n    .finally(() => {\n      dispatch(setLoadingAC(false));\n    });\n};\n"],"mappings":"AACA,SAASA,WAAW,QAAuB,kBAAkB;AAI7D,SAASC,UAAU,QAAQ,oBAAoB;AAU/C,MAAMC,YAA0B,GAAG,CAAC,CAAC;AACrC,MAAMC,KAAK,GAAGH,WAAW,CAAC;EACxBI,IAAI,EAAE,gBAAgB;EACtBF,YAAY,EAAEA,YAAY;EAC1BG,QAAQ,EAAE;IACRC,YAAYA,CAACC,KAAK,EAAEC,MAAgE,EAAE;MACpFD,KAAK,CAACC,MAAM,CAACC,OAAO,CAACC,IAAI,CAAC,CAACC,OAAO,GAAGH,MAAM,CAACC,OAAO,CAACE,OAAO;IAC7D,CAAC;IACDC,YAAYA,CAACL,KAAK,EAAEC,MAA4D,EAAE;MAChFD,KAAK,CAACM,OAAO,GAAGL,MAAM,CAACC,OAAO;IAChC,CAAC;IACDK,UAAUA,CAACP,KAAK,EAAEC,MAAoC,EAAE;MACtDD,KAAK,CAACQ,KAAK,GAAGP,MAAM,CAACC,OAAO;IAC9B;EACF;AACF,CAAC,CAAC;AAEF,OAAO,MAAMO,cAAc,GAAGb,KAAK,CAACc,OAAO;AAC3C,OAAO,MAAMX,YAAY,GAAGH,KAAK,CAACe,OAAO,CAACZ,YAAY;AACtD,OAAO,MAAMM,YAAY,GAAGT,KAAK,CAACe,OAAO,CAACN,YAAY;AACtD,OAAO,MAAME,UAAU,GAAGX,KAAK,CAACe,OAAO,CAACJ,UAAU;AAGlD,OAAO,MAAMK,SAAS,GAAIT,IAAY,IAAMU,QAAkB,IAAK;EACjEA,QAAQ,CAACR,YAAY,CAAC,IAAI,CAAC,CAAC;EAC5BQ,QAAQ,CAACN,UAAU,CAAC,IAAI,CAAC,CAAC;EAC1Bb,UAAU,CAACoB,UAAU,CAACX,IAAI,CAAC,CACxBY,IAAI,CAAEC,GAAG,IAAK;IAAA,IAAAC,qBAAA,EAAAC,sBAAA;IACbC,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEJ,GAAG,CAACK,IAAI,CAACC,QAAQ,CAACD,IAAI,CAACE,IAAI,CAACnB,OAAO,CAAC;IAC9DS,QAAQ,CAACd,YAAY,CAAC;MAAEK,OAAO,GAAAa,qBAAA,GAAED,GAAG,CAACK,IAAI,CAACC,QAAQ,CAACD,IAAI,cAAAJ,qBAAA,wBAAAC,sBAAA,GAAtBD,qBAAA,CAAwBM,IAAI,cAAAL,sBAAA,uBAA5BA,sBAAA,CAA8Bd,OAAO;MAAED;IAAK,CAAC,CAAC,CAAC;EAClF,CAAC,CAAC,CACDqB,KAAK,CAAEhB,KAAK,IAAK;IAChBK,QAAQ,CAAC;MAAEY,IAAI,EAAE,eAAe;MAAEvB,OAAO,EAAEM,KAAK,CAACkB;IAAQ,CAAC,CAAC;IAC3Db,QAAQ,CAACN,UAAU,CAAC,wBAAwB,CAAC,CAAC;EAChD,CAAC,CAAC,CACDoB,OAAO,CAAC,MAAM;IACbd,QAAQ,CAACR,YAAY,CAAC,KAAK,CAAC,CAAC;EAC/B,CAAC,CAAC;AACN,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}